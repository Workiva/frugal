sudo: required
dist: bionic
language: go
go:
  - "1.15.x"
git:
  depth: 1

env:
  - TWINE_USERNAME=messaging
  - TWINE_REPOSITORY=pypi

before_install:
  - mkdir -p $GOPATH/src/github.com/Workiva/frugal
  - rsync -av $TRAVIS_BUILD_DIR/ $GOPATH/src/github.com/Workiva/frugal
  - export TRAVIS_BUILD_DIR=$GOPATH/src/github.com/Workiva/frugal
  - cd $TRAVIS_BUILD_DIR
  # No need to install dart yet as we can't run the tests until thrift publishes dart to pub
  # - sudo sh -c 'curl https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -'
  # - sudo sh -c 'curl https://storage.googleapis.com/download.dartlang.org/linux/debian/dart_stable.list > /etc/apt/sources.list.d/dart_stable.list'
  - sudo apt update
  - sudo apt -y install python3-pip python3-venv python-dev python-virtualenv build-essential openjdk-8-jdk
  # The travis image comes with openjdk11 which has some bugs with checkstyle and javadoc.
  # Force openjdk1.8 until we can upgrade to 11 or 13
  - export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
  # sudo apt-get -y install dart

script:
  - make

cache:
  directories:
  - "~/.m2/repository"

after_success:
  - cd $TRAVIS_BUILD_DIR && ./scripts/travis/before-deploy-java.sh
  - cd $TRAVIS_BUILD_DIR && ./scripts/travis/deploy-java.sh
  - cd $TRAVIS_BUILD_DIR && ./scripts/travis/deploy-python.sh

notifications:
  email: false

env:
  global:
  # GPG_KEY_NAME
  - secure: QLfcf8lFmF67UAAr/Du7H2KWGV7yeSpueoZC2B9X9Fq8XH5Iv+CPR14miw2YWQjCrlGEo2WeMrUIo0Auz8xQsKCrQe69o7+mwpz79Z60RbzMqRSSUZgnnctwcNQLOsOmfZfElC7DFnL0r/dESsKZ9oMbsTFehQMtSL0dkQGEAiOP0IiAhwdx6a82D8pJemCX66a+e/I/lLZVrypR3HFmOyDNAs6Avpau0eUb28rHaV3iJTK4QvQm/U3ybwdXa0Bt5OacBbjVd9qZKy1dLeMABnhKu/e5Ue1q754pulBnovLItSZ1lTJBNCx64wxpMj/aB+msxDSUUr0sDHiET14Mu3pZS8WzitU2eXRQ84NEt77Ui5OjmLZuHnNjaLy5u0kpNGnL1zmirjFI6MqxOdehdeeAKYS//AZJ/lUe8vxVxxWMqNUtgKIZdl/dHjq4Y163aKpDBsbsrxohq3TiuJiZxIZQ6J8rgULymRfh9Gx83FJAHk4SSwSljrgTqYFmqi+eoPZ/BdxFka2WkxJULb5D9Zv91gw/fNxt1Fy3UtsSaWmpJBFpOO/C6nzqYvu+9aOs3S7pUgm6LeYwLIpsFu6Lw9NAfoYGvx+CvQNDEKlowlBnN6uyfjpU4QEWqZWDgoTUp3bw3NLk8KCSGhwTI8PzGJcs2WS4L4yJsysP98+5D8k=
  # GPG_PASSPHRASE
  - secure: auEV9hxeWBUQBoFwteVBx+mNWq7k5Tabg8LIHMAyRIx4licuICXFZt6ry81KOdmFIMaUgyyA4Puy4XEXS4y4THa4BB8rGVilQJjF+jmZExm2lLlk45jmj31205m+f/LtAXZFtsd+ErLJ4mAQM5RKBU2eTUalHgEydwidognu97CQnJrPHsV8F6oeYwiT3+cqQAFmZe2cZsGSYptVB4RAQIl8E8QRSUIO7/BdvUJdU3Byvs4d9AsRfqUV0++Mt8ZNeIkskjpglyLNU+KpbMXjBdD7OOZ0ygvEcABH9T3e+5IYJPZkF2Vwyw7RRpXMbXa3T7Bgxx/Z2D8/2PXx8M1jfQx2m7AkW8HpMghMRrD95Dh0c83bdeApSpHLWfHkli1g4CLvC8V78NmltIQqFApuI8/zKTbtcRo6VTUHgQy55Z0c2gkHY6hjlr09sfDiTry/j1sYduOBREaty2a4wVfzRfZNBLY9y1f59NQjVxaZ/68LIS1ppEpw/P/oWxwaXwf2/1zAwJLq5KBLY2i33AMEqsDpw4aaSflTv+nzmmM+mjHbpf3lpzw7lOeP5Wkn/i6G7uGqnQ6XZIpo7i+isLaCB8oDUOWXX0dH5mWOM9jspKqXfMTTo/6BsSpB14dO9ex2QkJZH+1BQ+Y+MZ9r72S0qEGAO9etp8L/VSK8IVg9kRI=
  # OSSRH_JIRA_USERNAME
  - secure: m+lNKmDWJyorSrWrvMh2hvRJULSjzitozeiunEHfMvueXI+mH0ii7qN81lwsok6dpRwoxlXD9lpNlKa8h+k5JaYgVbAj7BYy+IagGUnk4yp206IbXbOwEY4/ZHGWNl3NktvpADwKpu8lrqrAVZw9wrZ9wBxzxznsUhC6maohTxam+ejYo3sQrU0TrTvtQ73pU45rjjaFJAxTMSy8/cYvzsaFUl2V1D8O1c01aRwFU5ha1xIxqGpraMGc5aAqVQhNI07oEZvHWVqfBpnOg0RR/nPnL0xzWJ04o14aungFTNe202HiKIE8pMd9ElhWSkbZkgka8cAyfqKORgeTfY0u6ri8AwHys/MNUgX+CdtE+hTR2jqmIpAslDq/RGubvP0xCCbHUZeHIFQB6sNwGv5nc4i/7DRAQhKxPU6DTcSm4ZmESqGe/0mPb6OT9KJ0nel+aTmBRTthrFXhAz0JfTt3vsWdNUgegnb+2/IYFM8+2ufI7kCYQmpAd7QbaGTEotkX/eIsY1NXLdY7B4vV7nJfe7kUMCj83ZqTgj03rYyk7cyt62KPH4ocVmIld6vtwE1C/W9FdsBWh7Hhm/e7brfumoTH1dihW8wPepKxCdgwdZj2+WX0I8UY1N713wEYPo+T356PEMsD63uyosPRFvQIJYK9k/Fh+bR0ZKzZOrHSRwk=
  # OSSRH_JIRA_PASSWORD
  - secure: LUV6U/a7yh8MzgM7vOpdE5/61nXfRb/cysQ6O8J1N3OPUvgNg6vdD44gC0TZ65yRPlgcOx+xjlkxcmYjYN3pFDoMixHhO245vE1wqMKlKVZ3RI5qBPabZfDNTjva6q1H2LaY4k9e0xEQ57JTWTNRy6IA2slK9MyTFAiW+YwgJOhptdIw63pBczhrk42nVkID9/5N9AZ1MdM8oBLVBiQVOq+DTewt1HwmyejRbZEirp4A93FJkckvup5mGquLRm1pozS9yOrdLdJ9vThrCxGrsyM5MpHe7O33T1kLjGA9Kuseq7rEml1JzzzW/iBbcqJ/tkfagQnKYUBqNP0QAgOKDh6O0dkkANj7aKAd5AEMUTl2PzVhAUihh3cFVQPqGep/9URaPct6Lo6MGAMVYORMCJ3kEmXQWsrUu+qGOg4GMYcikYtXUhQSnih6j4RsMqOF0Kgx+tu+U5ygdq/VSiJeISM3jTtKaJoa6tBGS0ZZnp7oW9I1ZvrAQ2stgc6iPPjbIcKfcVV97U36NEaNcLY0WJz+c8/pkqwgPWZ5BDVwrzN2iWeo5+K7Pao+XAAfvP34nc+MfSs1I1zSAfqoO0UcJl5IjCG5X8+L8dpBFYKSyVyR0qWUaMrd3UK2iI5vhzfpMHsHxIsco7rZFgFagjrHvARTXFMNUg7V/wAKQhwG1Wk=
  # TWINE_PASSWORD
  - secure: wA5n9AW0eDDkVDdrDWaUX9B5N6bEIKAFi1uNJJCqRrv+iTfA8PnQGAwvo9fcNdSiATDOvjsGVLyYvitZGaGgm3LEiEnQjlVVi17jsMyVFWu/e/Nb69TyF+8HyAolv+LQ5JnkuG1qLQxN2pKQvR1ELOB8IKyEyS8Wdou9maYJT4LmLWQ0knZ0d2V+3rKgVqybYuFmS0/degoYgtMBX/BscxHuDVLje6n8m4CzTLhQsKA+ew8N8cLnzSTVIqqEhX7hPA74Jj9YDFRMepnWxo1d2ZTNggLgrYaQEcgD0FOPvcHUnlADeFfPq0LF7oY4cB3leAqHC1w/bR29VnvBqEtEViMDBGud/2rZMKK5rGxtCNXQSvhYfuMbiMlMn4l2Tg1fryFBf170jdDheybXEHsaZqTfX6ZaKD87o8TOjvqokEiDg28WyGzjN8y/MqBYHBeBxv4wx+cyLEyFEPATi7+CQ0tfoi7FmQ6cVElfQSgS3jKUMQnRLb4hzJrbmclnFZCmTqZW/PX7b8u6Y1lZ3SVOQeAb8Y2oCr3yVwnBidUjbvKrdDc8g4QQmG9OCawY90fgtpYSeQsu9+16Krk0LoEyn6+0HQzUPI676OjnpYlAIemT1yNVIY3iumXVOUkGqh3G0iEqb8BHMhWwXLYKRFuSVl4+XrlYMYsd55xEJ/loN6w=
  # NEW_RELIC
  - secure: "Qa+VmvxR8FgICUosrZ/9K2V5eahF7q7WobGcHgO52oNSaOAbcED4H9MCci8jtVVO7XqO/au2pQQqOp6jJzjbIoC8/qsbEzFXbHM4J8i2vfLrGYLzUgLvzDbznCfpNl+TLyUf2cHknrMAZ2iT1+cNdf1Qedi4Pucs2S3lAtbVyyHB13QV1AkR7B8Xluuz1TeVlRHosKE8vvYQmcsypL19Y3LHKvHo65nyB2tzWedcTpTVqV0Plt5z+Unc44xxCZBowDcziU2bW+h8aiy2J/5e9TQtIXOWLgYAsoFwLlAPqB0AXxJV/NsIaUGSNJuavAU6D8PRVJxdyaJSv06apUdcCihzWv5P2gOhu3brFyPAOSw1+iFBEP+mTezYNMzN2NFVcv41RNQBZUUw65W2zLpjdkHyliuYUbqUGKNOM8R5HXD+Z2O2/VsHhkaZviCU5tRKfC5RQgW8BB+GNweUVqmzsuakdbE44rry95Huo4hSLUb4ypanuqfjL8D0z1MD52puNqYGKgAnlgFoYYnZk/7KfFvW7+RLn4obfLcRWb958oe1KNfsbrs4uLJ0EGIK52rbrmwbk6nwFQMAHXiYoEbx3r7ndrIQm6+ZlrRPLhHiWPU2qaMzp0MPllDqCnYCO7ZOrlpvsWpgQXsDUtnM1hinkgZ/xzwXR772I2a5aMseY1k="
  - secure: "fS6q0Bur2nfrwAark2RFDQ618rAfBfuE8XOahbPIrz75CnTDHfZa3l3WlODMXuMCo0eZXNLq6+nqhSZ/lGe1Hh7KdVBFXDJZdpXw6qla3I5RPFQsGGb1SCZa/Dr3hbzp01UVaWaklOVdd2uNOr+XChXyGJYdsRD7P/8nCmbBg6IxByoaDT/fOTCEi0pYgMoK6DbqcRRilxAToSiDyIHHs7CnojpB1FcpW5quxAkMyGol/FUo89h/71Cq3OePKHLEvOwmsYw6eWcC6sKHctQa4zR+uTVdLJpaoYaC1V4bnxJa0aT6RbUFLsbd2r6pb83TknI4pFSh8enlA/xWxPs4LMGWdoYomGU+43svRpxAOENzJ/z//vz7ROAvl/zCd284Q0aG044dkL3WjUZR1pSZIcvwuOrvUa4UaZJN8id5o9jQwd9phSgwxD1XyZHsgXPN3PRX58JcMKrORowBddT0WqdcepFzUW9QukjlNDpevGAe51qC7ZAvzKn2XEyDuzax/yGW5xT2zDWVJm3B+1LtPboGpJu+X5vuJ1J1T5KKQPjAvH8fEtEJ/7JLIrYjDVMixUGXrF8oTjtsGl3rajWJZfeoJ9CuEGuUha2SR+piV3wJmffeRzWaMPfN2HzP9oBhahpLraiuoBVyBOZ3zRiJWHiqW+Q3/R7EELwt4U0ySEI="
  - secure: "aDti/SmAMYGHrLm1M0ngyUOWdVj6MjrwMZQTSR5/5UZ8ENmYbmLtybkWMr8mZW6Jvvj1vg31gteDrRpyUDW3bi5d71ymb5x7wzFXiZ6p+NnQFol9Woi3A7LNsd/zsB5x3dkewNwMhI/jP26WOuVI/Dh9gwyFHCkOUh3sYXIU07x+fzgQT8In3gzbERoA7QgYmOyPzL+CUhKJypUCaZX/86HXjuAHejGd+W11vA2PiElKvL+Kmx/YrfXA8DmXxksLjVzOUJmqG7nlibU0j4omYDU73auvtRrVBdriSPKC6HJud1pEF79TBjwskfGQUGEdu3LA/NrrWJD6q2hX13MRSAPqnB0BvJoMDL5Q8T1MIeaydiRXji2wfwfo6dTBC2I5jA8rEVdXWI6DLtPvjzhfW7gz5BygGCOiY1Hb5ynxMjs/mzobcPVZjvnnnYS2MnIrEZoTejCRlBXi+GU5kof8upRONylGe7FzZuCJbMyn2Blun3Ixeh9RTKCOghggbxXA4if5nIwCLEQA+egUb3mAAkCRpZVrP3affaQKxP5HbxgXdOBMlPkmdrSa7nDMKfoyjpE2FOpWldgqKA0IM6wiTaDKbUY2vk7AqIhIIq46ZJwthrzTpt0zHPwPuyyrA3T/thbEtpPz0vRHubstm2ZzrmBVBR13WcUrizZCJxA9q3s="
